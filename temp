SELECT owner, COUNT(*) AS table_count
FROM all_tables
WHERE owner NOT IN (
    'SYS', 'SYSTEM', 'XDB', 'ORDSYS', 'CTXSYS', 'DBSNMP', 'OUTLN',
    'ORDDATA', 'ORDPLUGINS', 'SI_INFORMTN_SCHEMA', 'MDSYS', 'OLAPSYS',
    'WMSYS', 'EXFSYS', 'SYSMAN', 'FLOWS_FILES', 'APEX_PUBLIC_USER',
    'ANONYMOUS', 'DVSYS', 'GSMADMIN_INTERNAL', 'LBACSYS'
)
AND owner NOT IN (
    SELECT username FROM dba_users WHERE ORACLE_MAINTAINED = 'Y'
)
GROUP BY owner
ORDER BY table_count DESC;
