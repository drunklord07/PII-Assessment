SELECT owner, COUNT(*) AS table_count
FROM all_tables
WHERE owner NOT IN (
    'SYS', 'SYSTEM', 'XDB', 'ORDSYS', 'CTXSYS', 'DBSNMP', 'OUTLN',
    'ORDDATA', 'ORDPLUGINS', 'SI_INFORMTN_SCHEMA', 'MDSYS', 'OLAPSYS',
    'WMSYS', 'EXFSYS', 'SYSMAN', 'FLOWS_FILES', 'APEX_PUBLIC_USER',
    'ANONYMOUS', 'DVSYS', 'GSMADMIN_INTERNAL', 'LBACSYS'
)
GROUP BY owner

UNION ALL

SELECT 'TOTAL' AS owner, COUNT(*)
FROM all_tables
WHERE owner NOT IN (
    'SYS', 'SYSTEM', 'XDB', 'ORDSYS', 'CTXSYS', 'DBSNMP', 'OUTLN',
    'ORDDATA', 'ORDPLUGINS', 'SI_INFORMTN_SCHEMA', 'MDSYS', 'OLAPSYS',
    'WMSYS', 'EXFSYS', 'SYSMAN', 'FLOWS_FILES', 'APEX_PUBLIC_USER',
    'ANONYMOUS', 'DVSYS', 'GSMADMIN_INTERNAL', 'LBACSYS'
)
-- Wrap everything in a subquery to apply correct ORDER BY
ORDER BY 
    CASE WHEN owner = 'TOTAL' THEN 2 ELSE 1 END,
    table_count DESC;
